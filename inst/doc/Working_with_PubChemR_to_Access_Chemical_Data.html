<!DOCTYPE html>

<html>

<head>

<meta charset="utf-8" />
<meta name="generator" content="pandoc" />
<meta http-equiv="X-UA-Compatible" content="IE=EDGE" />

<meta name="viewport" content="width=device-width, initial-scale=1" />

<meta name="author" content="Selcuk Korkmaz" />

<meta name="date" content="2023-11-23" />

<title>Working with PubChemR to Access Chemical Data</title>

<script>// Pandoc 2.9 adds attributes on both header and div. We remove the former (to
// be compatible with the behavior of Pandoc < 2.8).
document.addEventListener('DOMContentLoaded', function(e) {
  var hs = document.querySelectorAll("div.section[class*='level'] > :first-child");
  var i, h, a;
  for (i = 0; i < hs.length; i++) {
    h = hs[i];
    if (!/^h[1-6]$/i.test(h.tagName)) continue;  // it should be a header h1-h6
    a = h.attributes;
    while (a.length > 0) h.removeAttribute(a[0].name);
  }
});
</script>

<style type="text/css">
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
span.underline{text-decoration: underline;}
div.column{display: inline-block; vertical-align: top; width: 50%;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
</style>



<style type="text/css">
code {
white-space: pre;
}
.sourceCode {
overflow: visible;
}
</style>
<style type="text/css" data-origin="pandoc">
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
{ counter-reset: source-line 0; }
pre.numberSource code > span
{ position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
{ content: counter(source-line);
position: relative; left: -1em; text-align: right; vertical-align: baseline;
border: none; display: inline-block;
-webkit-touch-callout: none; -webkit-user-select: none;
-khtml-user-select: none; -moz-user-select: none;
-ms-user-select: none; user-select: none;
padding: 0 4px; width: 4em;
color: #aaaaaa;
}
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa; padding-left: 4px; }
div.sourceCode
{ }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } 
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } 
code span.at { color: #7d9029; } 
code span.bn { color: #40a070; } 
code span.bu { color: #008000; } 
code span.cf { color: #007020; font-weight: bold; } 
code span.ch { color: #4070a0; } 
code span.cn { color: #880000; } 
code span.co { color: #60a0b0; font-style: italic; } 
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } 
code span.do { color: #ba2121; font-style: italic; } 
code span.dt { color: #902000; } 
code span.dv { color: #40a070; } 
code span.er { color: #ff0000; font-weight: bold; } 
code span.ex { } 
code span.fl { color: #40a070; } 
code span.fu { color: #06287e; } 
code span.im { color: #008000; font-weight: bold; } 
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } 
code span.kw { color: #007020; font-weight: bold; } 
code span.op { color: #666666; } 
code span.ot { color: #007020; } 
code span.pp { color: #bc7a00; } 
code span.sc { color: #4070a0; } 
code span.ss { color: #bb6688; } 
code span.st { color: #4070a0; } 
code span.va { color: #19177c; } 
code span.vs { color: #4070a0; } 
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } 
</style>
<script>
// apply pandoc div.sourceCode style to pre.sourceCode instead
(function() {
  var sheets = document.styleSheets;
  for (var i = 0; i < sheets.length; i++) {
    if (sheets[i].ownerNode.dataset["origin"] !== "pandoc") continue;
    try { var rules = sheets[i].cssRules; } catch (e) { continue; }
    var j = 0;
    while (j < rules.length) {
      var rule = rules[j];
      // check if there is a div.sourceCode rule
      if (rule.type !== rule.STYLE_RULE || rule.selectorText !== "div.sourceCode") {
        j++;
        continue;
      }
      var style = rule.style.cssText;
      // check if color or background-color is set
      if (rule.style.color === '' && rule.style.backgroundColor === '') {
        j++;
        continue;
      }
      // replace div.sourceCode by a pre.sourceCode rule
      sheets[i].deleteRule(j);
      sheets[i].insertRule('pre.sourceCode{' + style + '}', j);
    }
  }
})();
</script>




<style type="text/css">body {
background-color: #fff;
margin: 1em auto;
max-width: 700px;
overflow: visible;
padding-left: 2em;
padding-right: 2em;
font-family: "Open Sans", "Helvetica Neue", Helvetica, Arial, sans-serif;
font-size: 14px;
line-height: 1.35;
}
#TOC {
clear: both;
margin: 0 0 10px 10px;
padding: 4px;
width: 400px;
border: 1px solid #CCCCCC;
border-radius: 5px;
background-color: #f6f6f6;
font-size: 13px;
line-height: 1.3;
}
#TOC .toctitle {
font-weight: bold;
font-size: 15px;
margin-left: 5px;
}
#TOC ul {
padding-left: 40px;
margin-left: -1.5em;
margin-top: 5px;
margin-bottom: 5px;
}
#TOC ul ul {
margin-left: -2em;
}
#TOC li {
line-height: 16px;
}
table {
margin: 1em auto;
border-width: 1px;
border-color: #DDDDDD;
border-style: outset;
border-collapse: collapse;
}
table th {
border-width: 2px;
padding: 5px;
border-style: inset;
}
table td {
border-width: 1px;
border-style: inset;
line-height: 18px;
padding: 5px 5px;
}
table, table th, table td {
border-left-style: none;
border-right-style: none;
}
table thead, table tr.even {
background-color: #f7f7f7;
}
p {
margin: 0.5em 0;
}
blockquote {
background-color: #f6f6f6;
padding: 0.25em 0.75em;
}
hr {
border-style: solid;
border: none;
border-top: 1px solid #777;
margin: 28px 0;
}
dl {
margin-left: 0;
}
dl dd {
margin-bottom: 13px;
margin-left: 13px;
}
dl dt {
font-weight: bold;
}
ul {
margin-top: 0;
}
ul li {
list-style: circle outside;
}
ul ul {
margin-bottom: 0;
}
pre, code {
background-color: #f7f7f7;
border-radius: 3px;
color: #333;
white-space: pre-wrap; 
}
pre {
border-radius: 3px;
margin: 5px 0px 10px 0px;
padding: 10px;
}
pre:not([class]) {
background-color: #f7f7f7;
}
code {
font-family: Consolas, Monaco, 'Courier New', monospace;
font-size: 85%;
}
p > code, li > code {
padding: 2px 0px;
}
div.figure {
text-align: center;
}
img {
background-color: #FFFFFF;
padding: 2px;
border: 1px solid #DDDDDD;
border-radius: 3px;
border: 1px solid #CCCCCC;
margin: 0 5px;
}
h1 {
margin-top: 0;
font-size: 35px;
line-height: 40px;
}
h2 {
border-bottom: 4px solid #f7f7f7;
padding-top: 10px;
padding-bottom: 2px;
font-size: 145%;
}
h3 {
border-bottom: 2px solid #f7f7f7;
padding-top: 10px;
font-size: 120%;
}
h4 {
border-bottom: 1px solid #f7f7f7;
margin-left: 8px;
font-size: 105%;
}
h5, h6 {
border-bottom: 1px solid #ccc;
font-size: 105%;
}
a {
color: #0033dd;
text-decoration: none;
}
a:hover {
color: #6666ff; }
a:visited {
color: #800080; }
a:visited:hover {
color: #BB00BB; }
a[href^="http:"] {
text-decoration: underline; }
a[href^="https:"] {
text-decoration: underline; }

code > span.kw { color: #555; font-weight: bold; } 
code > span.dt { color: #902000; } 
code > span.dv { color: #40a070; } 
code > span.bn { color: #d14; } 
code > span.fl { color: #d14; } 
code > span.ch { color: #d14; } 
code > span.st { color: #d14; } 
code > span.co { color: #888888; font-style: italic; } 
code > span.ot { color: #007020; } 
code > span.al { color: #ff0000; font-weight: bold; } 
code > span.fu { color: #900; font-weight: bold; } 
code > span.er { color: #a61717; background-color: #e3d2d2; } 
</style>




</head>

<body>




<h1 class="title toc-ignore">Working with PubChemR to Access Chemical
Data</h1>
<h4 class="author">Selcuk Korkmaz</h4>
<h4 class="date">2023-11-23</h4>



<div id="introduction-to-the-pubchemr-package" class="section level2">
<h2>1. Introduction to the <code>PubChemR</code> Package</h2>
<div id="overview" class="section level3">
<h3>Overview</h3>
<p><code>PubChemR</code> is an R package designed to facilitate seamless
interaction with the PubChem database, a comprehensive resource for
chemical information. This package provides a user-friendly interface to
query and retrieve data from PubChem, which includes detailed
information on chemical compounds, substances, and biological
assays.</p>
</div>
<div id="purpose" class="section level3">
<h3>Purpose</h3>
<p>The primary purpose of <code>PubChemR</code> is to enable
researchers, chemists, and data scientists to access and utilize the
wealth of chemical information available in the PubChem database
directly from their R environment. This integration allows for efficient
data retrieval, manipulation, and analysis within a familiar R
framework, enhancing the workflow for chemical data analysis.</p>
</div>
<div id="main-features" class="section level3">
<h3>Main Features</h3>
<p><strong>Data Retrieval:</strong> <code>PubChemR</code> offers
functions to query and retrieve detailed information about chemical
compounds, substances, and assays. This includes structural information,
properties, biological activities, and more.</p>
<p><strong>Data Processing:</strong> The package includes utilities to
process and transform the retrieved data into user-friendly formats,
such as data frames or lists, suitable for further analysis in R.</p>
<p><strong>Integration with R Environment:</strong> The package is
designed to integrate smoothly with the R ecosystem, allowing users to
leverage other R packages and tools for data analysis, visualization,
and reporting.</p>
</div>
<div id="prerequisites-and-dependencies" class="section level3">
<h3>Prerequisites and Dependencies</h3>
<p><strong>R Environment:</strong> PubChemR is an R package and requires
an R environment to run. It is recommended to use the latest version of
R for optimal performance.</p>
<p><strong>Required R Packages:</strong> <code>PubChemR</code> may
depend on other R packages for certain functionalities, such as httr for
HTTP requests, jsonlite for JSON processing, and dplyr or tidyverse for
data manipulation.</p>
<p><strong>API Keys:</strong> While <code>PubChemR</code> primarily
interacts with public APIs that do not require authentication, users
should check if any specific functions or extended usage require an API
key from PubChem or related services.</p>
</div>
</div>
<div id="installation" class="section level2">
<h2>2. Installation</h2>
<p><code>PubChemR</code> can be installed from CRAN or directly from its
GitHub repository (if available). Users can install the package using
standard R package installation commands.</p>
<div class="sourceCode" id="cb1"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1-1"><a href="#cb1-1" tabindex="-1"></a><span class="co"># Install from CRAN</span></span>
<span id="cb1-2"><a href="#cb1-2" tabindex="-1"></a><span class="fu">install.packages</span>(<span class="st">&quot;PubChemR&quot;</span>)</span>
<span id="cb1-3"><a href="#cb1-3" tabindex="-1"></a></span>
<span id="cb1-4"><a href="#cb1-4" tabindex="-1"></a><span class="co"># Or, install the development version from GitHub</span></span>
<span id="cb1-5"><a href="#cb1-5" tabindex="-1"></a><span class="fu">install.packages</span>(<span class="st">&quot;devtools&quot;</span>)</span>
<span id="cb1-6"><a href="#cb1-6" tabindex="-1"></a>devtools<span class="sc">::</span><span class="fu">install_github</span>(<span class="st">&quot;selcukorkmaz/PubChemR&quot;</span>)</span></code></pre></div>
</div>
<div id="setup" class="section level2">
<h2>3. Setup</h2>
<p>Before diving into the functionalities of the <code>PubChemR</code>
package, it’s essential to set up your R environment by loading
<code>PubChemR</code> along with any other necessary libraries. This
step ensures that all the functions and features of the package are
readily available for use.</p>
<div id="loading-the-pubchemr-package" class="section level3">
<h3>Loading the <code>PubChemR</code> Package</h3>
<p>First, you need to load the <code>PubChemR</code> package into your R
session. If you haven’t already installed the package, refer to the
installation instructions provided in the Introduction section.</p>
<div class="sourceCode" id="cb2"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb2-1"><a href="#cb2-1" tabindex="-1"></a><span class="co"># Load the PubChemR package</span></span>
<span id="cb2-2"><a href="#cb2-2" tabindex="-1"></a><span class="fu">library</span>(PubChemR)</span></code></pre></div>
</div>
<div id="verifying-the-setup" class="section level3">
<h3>Verifying the Setup</h3>
<p>After loading the package and any additional libraries, it’s good
practice to verify that everything is set up correctly. You can do this
by calling a simple function from the package to check if it executes
without errors.</p>
<div class="sourceCode" id="cb3"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb3-1"><a href="#cb3-1" tabindex="-1"></a><span class="co"># Example function call to verify setup</span></span>
<span id="cb3-2"><a href="#cb3-2" tabindex="-1"></a>example_result <span class="ot">&lt;-</span> <span class="fu">pubchem_summary</span>(<span class="st">&quot;aspirin&quot;</span>, <span class="st">&quot;name&quot;</span>)</span>
<span id="cb3-3"><a href="#cb3-3" tabindex="-1"></a><span class="co">#&gt; Successfully retrieved compound data.</span></span>
<span id="cb3-4"><a href="#cb3-4" tabindex="-1"></a><span class="co">#&gt; Successfully retrieved CIDs.</span></span>
<span id="cb3-5"><a href="#cb3-5" tabindex="-1"></a><span class="co">#&gt; Successfully retrieved substance data.</span></span>
<span id="cb3-6"><a href="#cb3-6" tabindex="-1"></a><span class="co">#&gt; Successfully retrieved SIDs</span></span>
<span id="cb3-7"><a href="#cb3-7" tabindex="-1"></a>example_result<span class="sc">$</span>CIDs</span>
<span id="cb3-8"><a href="#cb3-8" tabindex="-1"></a><span class="co">#&gt; # A tibble: 1 × 2</span></span>
<span id="cb3-9"><a href="#cb3-9" tabindex="-1"></a><span class="co">#&gt;   Compound CID  </span></span>
<span id="cb3-10"><a href="#cb3-10" tabindex="-1"></a><span class="co">#&gt;   &lt;chr&gt;    &lt;chr&gt;</span></span>
<span id="cb3-11"><a href="#cb3-11" tabindex="-1"></a><span class="co">#&gt; 1 aspirin  2244</span></span></code></pre></div>
<p>This setup section ensures that users have everything they need to
start working with the <code>PubChemR</code> package effectively. The
next sections of the vignette will delve into specific functionalities
and use cases of the package.</p>
</div>
</div>
<div id="overview-of-functions" class="section level2">
<h2>4. Overview of Functions</h2>
<p>The <code>PubChemR</code> package offers a suite of functions
designed to interact with the PubChem database, allowing users to
retrieve and manipulate chemical data efficiently. Below is an overview
of the main functions provided by the package, along with brief
descriptions of their purposes:</p>
<div id="pubchem_summary" class="section level3">
<h3>1. <code>pubchem_summary()</code></h3>
<p><strong>Purpose</strong></p>
<p>The <code>pubchem_summary</code> function is designed to fetch and
summarize various types of data from the PubChem database. It can
retrieve information about compounds, substances, assays, and their
associated properties, synonyms, and structural data files (SDF).</p>
<p><strong>Parameters</strong></p>
<ul>
<li><code>identifier</code>: The specific identifier for the query. This
could be a compound ID (CID), substance ID (SID), assay ID (AID), or a
name.</li>
<li><code>namespace</code>: Specifies the type of identifier being used
(e.g., ‘cid’, ‘name’).</li>
<li><code>type</code>: A character vector indicating the type of data to
retrieve. Options include “compound”, “substance”, and “assay”.</li>
<li><code>properties</code>: Optional. A list of properties to retrieve
for the given identifier.</li>
<li><code>include_synonyms</code>: Boolean. If TRUE, retrieves synonyms
for the identifier.</li>
<li><code>include_sdf</code>: Boolean. If TRUE, downloads the SDF file
for the compound.</li>
<li><code>sdf_path</code>: Optional. Specifies the path for saving the
SDF file. If NULL, the file is saved into a <strong>temprorary
folder</strong>.</li>
<li><code>sdf_file_name</code>: Optional. Specifies the name of
downloaded SDF file. If NULL, the file name is retrieved from
<code>identifier</code> input.</li>
<li><code>...</code>: Additional arguments that might be passed to
internal functions.</li>
</ul>
<p><strong>Functionality</strong></p>
<p><strong>1. Data Retrieval:</strong> Based on the
<code>namespace</code> and <code>type</code>, the function fetches data
from PubChem. It can retrieve data about compounds, substances, and
assays. <strong>2. Error Handling:</strong> The function uses
<code>tryCatch</code> to handle any errors during data retrieval,
providing informative messages about the success or failure of each
operation. <strong>3. Synonyms and Properties:</strong> If requested,
the function can also fetch synonyms and specified properties of the
identifier. <strong>4. SDF File Download:</strong> If
<code>include_sdf</code> is TRUE, the function downloads the SDF file
for the compound and saves it either in the specified path or the
current working directory.</p>
<p><strong>Usage</strong></p>
<p>The function is used to aggregate various types of information from
PubChem for a given identifier. It simplifies the process of fetching
detailed data from PubChem by wrapping multiple queries into a single
function call.</p>
<p><strong>Example</strong></p>
<div class="sourceCode" id="cb4"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb4-1"><a href="#cb4-1" tabindex="-1"></a>pubchemSummary <span class="ot">&lt;-</span> <span class="fu">pubchem_summary</span>(</span>
<span id="cb4-2"><a href="#cb4-2" tabindex="-1"></a>  <span class="at">identifier =</span> <span class="st">&quot;aspirin&quot;</span>,</span>
<span id="cb4-3"><a href="#cb4-3" tabindex="-1"></a>  <span class="at">namespace =</span> <span class="st">&#39;name&#39;</span>,</span>
<span id="cb4-4"><a href="#cb4-4" tabindex="-1"></a>  <span class="at">type =</span> <span class="fu">c</span>(<span class="st">&quot;compound&quot;</span>, <span class="st">&quot;substance&quot;</span>, <span class="st">&quot;assay&quot;</span>),</span>
<span id="cb4-5"><a href="#cb4-5" tabindex="-1"></a>  <span class="at">properties =</span> <span class="st">&quot;IsomericSMILES&quot;</span>,</span>
<span id="cb4-6"><a href="#cb4-6" tabindex="-1"></a>  <span class="at">include_synonyms =</span> <span class="cn">TRUE</span>,</span>
<span id="cb4-7"><a href="#cb4-7" tabindex="-1"></a>  <span class="at">include_sdf =</span> <span class="cn">FALSE</span>,</span>
<span id="cb4-8"><a href="#cb4-8" tabindex="-1"></a>  <span class="at">sdf_path =</span> <span class="cn">NULL</span></span>
<span id="cb4-9"><a href="#cb4-9" tabindex="-1"></a>)</span>
<span id="cb4-10"><a href="#cb4-10" tabindex="-1"></a><span class="co">#&gt; Successfully retrieved compound data.</span></span>
<span id="cb4-11"><a href="#cb4-11" tabindex="-1"></a><span class="co">#&gt; Successfully retrieved CIDs.</span></span>
<span id="cb4-12"><a href="#cb4-12" tabindex="-1"></a><span class="co">#&gt; Successfully retrieved substance data.</span></span>
<span id="cb4-13"><a href="#cb4-13" tabindex="-1"></a><span class="co">#&gt; Successfully retrieved SIDs</span></span>
<span id="cb4-14"><a href="#cb4-14" tabindex="-1"></a><span class="co">#&gt; Successfully retrieved synonyms data.</span></span>
<span id="cb4-15"><a href="#cb4-15" tabindex="-1"></a><span class="co">#&gt; Successfully retrieved properties data.</span></span>
<span id="cb4-16"><a href="#cb4-16" tabindex="-1"></a>pubchemSummary<span class="sc">$</span>CIDs</span>
<span id="cb4-17"><a href="#cb4-17" tabindex="-1"></a><span class="co">#&gt; # A tibble: 1 × 2</span></span>
<span id="cb4-18"><a href="#cb4-18" tabindex="-1"></a><span class="co">#&gt;   Compound CID  </span></span>
<span id="cb4-19"><a href="#cb4-19" tabindex="-1"></a><span class="co">#&gt;   &lt;chr&gt;    &lt;chr&gt;</span></span>
<span id="cb4-20"><a href="#cb4-20" tabindex="-1"></a><span class="co">#&gt; 1 aspirin  2244</span></span></code></pre></div>
<p>This example retrieves data for aspirin, including compound details,
and synonyms, and stores the results in the variable
<code>pubchemSummary</code>. This example retrieves data for aspirin,
including compound details, and synonyms, and stores the results in the
variable <code>r</code>. To save SDF file, one may set
<code>include_sdf = TRUE</code> and define the path to save downloaded
file via <code>sdf_path</code> and the file name via
<code>sdf_file_name</code>. If both arguments, i.e.,
<code>sdf_path</code> and <code>sdf_file_name</code> are set NULL, the
downloaded file will be saved into a <strong>temporary folder</strong>
with a file name retrieved from <code>identifier</code> argument. See
below for an example</p>
<div class="sourceCode" id="cb5"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb5-1"><a href="#cb5-1" tabindex="-1"></a><span class="co"># Save downloaded SDF file into a temporary folder.</span></span>
<span id="cb5-2"><a href="#cb5-2" tabindex="-1"></a>pubchemSummary <span class="ot">&lt;-</span> <span class="fu">pubchem_summary</span>(</span>
<span id="cb5-3"><a href="#cb5-3" tabindex="-1"></a>  <span class="at">identifier =</span> <span class="st">&quot;aspirin&quot;</span>,</span>
<span id="cb5-4"><a href="#cb5-4" tabindex="-1"></a>  <span class="at">namespace =</span> <span class="st">&#39;name&#39;</span>,</span>
<span id="cb5-5"><a href="#cb5-5" tabindex="-1"></a>  <span class="at">type =</span> <span class="fu">c</span>(<span class="st">&quot;compound&quot;</span>, <span class="st">&quot;substance&quot;</span>, <span class="st">&quot;assay&quot;</span>),</span>
<span id="cb5-6"><a href="#cb5-6" tabindex="-1"></a>  <span class="at">properties =</span> <span class="st">&quot;IsomericSMILES&quot;</span>,</span>
<span id="cb5-7"><a href="#cb5-7" tabindex="-1"></a>  <span class="at">include_synonyms =</span> <span class="cn">TRUE</span>,</span>
<span id="cb5-8"><a href="#cb5-8" tabindex="-1"></a>  <span class="at">include_sdf =</span> <span class="cn">TRUE</span>, </span>
<span id="cb5-9"><a href="#cb5-9" tabindex="-1"></a>  <span class="at">sdf_path =</span> <span class="cn">NULL</span>, </span>
<span id="cb5-10"><a href="#cb5-10" tabindex="-1"></a>  <span class="at">sdf_file_name =</span> <span class="st">&quot;Aspirin&quot;</span></span>
<span id="cb5-11"><a href="#cb5-11" tabindex="-1"></a>)</span>
<span id="cb5-12"><a href="#cb5-12" tabindex="-1"></a>pubchemSummary<span class="sc">$</span>CIDs</span></code></pre></div>
<blockquote>
<blockquote>
<blockquote>
<blockquote>
<blockquote>
<blockquote>
<blockquote>
<p>b2bca3ff8aa37fe371187dcb523282d79d2e17ba</p>
</blockquote>
</blockquote>
</blockquote>
</blockquote>
</blockquote>
</blockquote>
</blockquote>
<p><strong>Notes</strong></p>
<ul>
<li>The function’s effectiveness depends on the availability and
responsiveness of the PubChem API.</li>
<li>Proper error handling ensures that the function provides informative
feedback in case of any issues with data retrieval.</li>
</ul>
</div>
<div id="get_aids" class="section level3">
<h3>2. <code>get_aids()</code></h3>
<p><strong>Purpose</strong></p>
<p>The <code>get_aids</code> function in the <code>PubChemR</code>
package is designed to retrieve Assay IDs (AIDs) from the PubChem
database for a given set of identifiers. This function is particularly
useful for researchers and scientists who need to access assay
information related to specific compounds, substances, or other entities
in PubChem.</p>
<p><strong>Parameters</strong></p>
<ul>
<li><code>identifier</code>: A vector of identifiers, which can be
positive integers (like CID, SID, AID) or strings (like names, SMILES,
InChIKeys).</li>
<li><code>namespace</code>: Specifies the namespace for the query,
indicating the type of identifier used (e.g., ‘cid’, ‘name’).</li>
<li><code>domain</code>: The domain of the query, such as ‘compound’,
‘substance’, ‘assay’, etc.</li>
<li><code>searchtype</code>: Defines the type of search to be performed,
such as ‘substructure’, ‘superstructure’, ‘similarity’, etc.</li>
<li><code>as_data_frame</code>: A logical flag indicating whether to
return the results as a data frame (tibble) or not. Defaults to
TRUE.</li>
<li><code>...</code>: Additional arguments passed to the internal
function <code>get_json</code>.</li>
</ul>
<p><strong>Functionality</strong></p>
<p><strong>1. Data Retrieval:</strong> The function sends a request to
PubChem to fetch AIDs based on the provided identifiers and parameters.
<strong>2. Response Parsing:</strong> It parses the JSON response to
extract AIDs. <strong>3. Data Formatting:</strong> Depending on the
<code>as_data_frame</code> flag, the function either formats the results
into a tibble (data frame) or returns them as a list. <strong>4. Error
Handling:</strong> The function includes error handling to manage and
report any issues during the data retrieval process.</p>
<p><strong>Usage</strong></p>
<p>This function is used to obtain assay information from PubChem, which
is essential for various biochemical and pharmacological research
purposes. It simplifies the process of querying PubChem for assay
data.</p>
<p><strong>Example</strong></p>
<div class="sourceCode" id="cb6"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb6-1"><a href="#cb6-1" tabindex="-1"></a>getAIDs <span class="ot">&lt;-</span> <span class="fu">get_aids</span>(</span>
<span id="cb6-2"><a href="#cb6-2" tabindex="-1"></a>  <span class="at">identifier =</span> <span class="st">&quot;aspirin&quot;</span>,</span>
<span id="cb6-3"><a href="#cb6-3" tabindex="-1"></a>  <span class="at">namespace =</span> <span class="st">&quot;name&quot;</span></span>
<span id="cb6-4"><a href="#cb6-4" tabindex="-1"></a>)</span>
<span id="cb6-5"><a href="#cb6-5" tabindex="-1"></a><span class="fu">head</span>(getAIDs)</span>
<span id="cb6-6"><a href="#cb6-6" tabindex="-1"></a><span class="co">#&gt; # A tibble: 6 × 3</span></span>
<span id="cb6-7"><a href="#cb6-7" tabindex="-1"></a><span class="co">#&gt;   Compound   CID   AID</span></span>
<span id="cb6-8"><a href="#cb6-8" tabindex="-1"></a><span class="co">#&gt;   &lt;chr&gt;    &lt;dbl&gt; &lt;dbl&gt;</span></span>
<span id="cb6-9"><a href="#cb6-9" tabindex="-1"></a><span class="co">#&gt; 1 aspirin   2244     1</span></span>
<span id="cb6-10"><a href="#cb6-10" tabindex="-1"></a><span class="co">#&gt; 2 aspirin   2244     3</span></span>
<span id="cb6-11"><a href="#cb6-11" tabindex="-1"></a><span class="co">#&gt; 3 aspirin   2244     9</span></span>
<span id="cb6-12"><a href="#cb6-12" tabindex="-1"></a><span class="co">#&gt; 4 aspirin   2244    15</span></span>
<span id="cb6-13"><a href="#cb6-13" tabindex="-1"></a><span class="co">#&gt; 5 aspirin   2244    19</span></span>
<span id="cb6-14"><a href="#cb6-14" tabindex="-1"></a><span class="co">#&gt; 6 aspirin   2244    21</span></span></code></pre></div>
<p>In this example, the function retrieves AIDs associated with
“aspirin” from PubChem and returns them in a data frame format.</p>
<p><strong>Notes</strong></p>
<ul>
<li>The function’s performance and accuracy depend on the current state
and availability of the PubChem database.</li>
<li>Proper error handling ensures that the function provides useful
feedback in case of any issues with data retrieval or processing.</li>
<li>The function is versatile, allowing for different types of
identifiers and query parameters, making it suitable for a wide range of
use cases.</li>
</ul>
</div>
<div id="get_cids" class="section level3">
<h3>3. <code>get_cids()</code></h3>
<p><strong>Purpose</strong> The <code>get_cids</code> function is
designed to interact with the PubChem database to retrieve Compound IDs
(CIDs) based on a given set of identifiers. This function is
particularly useful for users who need to convert various types of
chemical identifiers into CIDs, which are unique numerical identifiers
assigned to chemical compounds by PubChem.</p>
<p><strong>Parameters</strong> * <code>identifier</code>: This is a
vector containing identifiers. These identifiers can be a mix of
positive integers (like cid, sid, aid) or strings (such as source,
inchikey, formula). The function is flexible enough to handle different
types of identifiers, including names, SMILES strings, and more.</p>
<ul>
<li><p><code>namespace</code>: This parameter specifies the context or
category of the identifier. For compounds, it can be ‘cid’, ‘name’,
‘smiles’, ‘inchi’, etc. The namespace helps the function understand the
type of the provided identifier.</p></li>
<li><p><code>domain</code>: It indicates the domain of the query.
Possible values include ‘substance’, ‘compound’, ‘assay’, and others.
This parameter helps in narrowing down the search to a specific domain
in PubChem.</p></li>
<li><p><code>searchtype</code>: This parameter defines the type of
search to be performed. It can be a combination of search types like
‘substructure’, ‘superstructure’, ‘similarity’, ‘identity’, etc., along
with the identifier type.</p></li>
<li><p><code>...</code>: This is a placeholder for additional arguments
that can be passed to the underlying get_json function, which is assumed
to be a part of the package for handling JSON data from
PubChem.</p></li>
</ul>
<p><strong>Functionality</strong> The function returns a tibble (a
modern version of a data frame in R), where each row corresponds to an
identifier and its associated CID(s). The tibble contains columns
‘Compound’ and ‘CID’, making it easy to understand and manipulate the
data.</p>
<p><strong>Usage</strong></p>
<div class="sourceCode" id="cb7"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb7-1"><a href="#cb7-1" tabindex="-1"></a>getCIDs <span class="ot">&lt;-</span> <span class="fu">get_cids</span>(</span>
<span id="cb7-2"><a href="#cb7-2" tabindex="-1"></a>  <span class="at">identifier =</span> <span class="st">&quot;aspirin&quot;</span>,</span>
<span id="cb7-3"><a href="#cb7-3" tabindex="-1"></a>  <span class="at">namespace =</span> <span class="st">&quot;name&quot;</span></span>
<span id="cb7-4"><a href="#cb7-4" tabindex="-1"></a>)</span>
<span id="cb7-5"><a href="#cb7-5" tabindex="-1"></a>getCIDs</span>
<span id="cb7-6"><a href="#cb7-6" tabindex="-1"></a><span class="co">#&gt; # A tibble: 1 × 2</span></span>
<span id="cb7-7"><a href="#cb7-7" tabindex="-1"></a><span class="co">#&gt;   Compound CID  </span></span>
<span id="cb7-8"><a href="#cb7-8" tabindex="-1"></a><span class="co">#&gt;   &lt;chr&gt;    &lt;chr&gt;</span></span>
<span id="cb7-9"><a href="#cb7-9" tabindex="-1"></a><span class="co">#&gt; 1 aspirin  2244</span></span></code></pre></div>
<p><strong>Additional Notes</strong> * The function uses
<code>tryCatch</code> to handle any errors during the API request and
parsing of the response. * It employs various <code>tidyverse</code>
functions like <code>unnest_wider</code>, <code>unnest_longer</code>,
and <code>mutate</code> to reshape the data into a user-friendly format.
* The function assumes the existence of a <code>get_json</code> function
in the package, which is responsible for making the actual API request
and returning the JSON response. * This function is a key component of
the PubChemR package, enabling users to seamlessly convert various
chemical identifiers into PubChem CIDs, which are essential for further
chemical data exploration and analysis.</p>
</div>
</div>



<!-- code folding -->


<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    script.src  = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML";
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>

</body>
</html>
